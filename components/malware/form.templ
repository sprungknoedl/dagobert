package malware

import (
	"github.com/sprungknoedl/dagobert/components/utils"
    "github.com/sprungknoedl/dagobert/pkg/valid"
)

type MalwareDTO struct {
    ID       int64
    CaseID   int64
	Filename string `form:"filename"`
	Filepath string `form:"filepath"`
	CDate    string `form:"cDate"`
	MDate    string `form:"mDate"`
	System   string `form:"system"`
	Hash     string `form:"hash"`
	Notes    string `form:"notes"`
}


templ Form(env utils.Env, obj MalwareDTO, vr valid.Result) {
    @utils.Modal("max-w-4xl") {
        <form hx-post={env.Routes("save-malware", obj.CaseID, obj.ID)} hx-target="#modal">
        @utils.ModalHeader() {
            if obj.ID == 0 {
                Add malware
            } else {
                Edit malware
            }
        }
                
        @utils.ModalBody() {
            @utils.TextInput("System", "system", obj.System, true, vr["System"])
            @utils.TextInput("Filename", "filename", obj.Filename, true, vr["Filename"])
            @utils.TextInput("Path", "filepath", obj.Filepath, false, vr["Filepath"])
            @utils.TextInput("Create Date", "cdate", obj.CDate, false, vr["CDate"])
            @utils.TextInput("Modify Date", "mdate", obj.MDate, false, vr["MDate"])
            @utils.TextInput("Hash", "hash", obj.Hash, false, vr["Hash"])
            @utils.TextInput("Notes", "notes", obj.Notes, false, vr["Notes"])
        }

        @utils.DefaultCrudFooter() {}
        </form>
    }
}